var tinyshop={name:"tinyshop javascript library",version:"1.0",instanceid:1000011,messagecode:1e5,csp:["Access-Control-Allow-Origin","*"],xhr:function(){var e=null,t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];try{e=new XMLHttpRequest}catch(a){for(var s=0;s<t.length;s++)try{e=new ActiveXObject(t[s])}catch(e){continue}}return e},message:function(e){this.message(escape(e)+"\n"+"-".repeat(32)+"\n#TS-MSGC-"+this.messagecode),this.messagecode<Number.MAX_SAFE_INTEGER&&this.messagecode++},redirect:function(e){document.location=e?escape(e):location.href},math:function(e,t,s=1){switch(e){case"int":if(s>1)for(;s>0;)this.math("int",t,s),this.result=parseInt(t),s--;else this.result=parseInt(t);break;case"float":this.result=parseFloat(t)}return null},rnd:function(e="rand",t=null,s=null,a=null){switch(e){case"rand":case"bytes":this.r=Math.random()}return this.r},addtocart:function(e){this.id=this.math("int",e,1),this.fetchHTML("/cart/"+this.rnd()+"/addtocart/"+this.id+"/","GET","result")},toggle:function(e,t){for(i=0;i<t;i++)try{this.dom("toggle"+e,"display","none"),this.dom("cat"+e,"fontWeight","100")}catch(e){}this.dom("toggle"+e,"display","block"),this.dom("cat"+e,"fontWeight","bold")},dom:function(e,t,s=""){switch(t){case"get":return document.getElementById(escape(e)).value;case"set":document.getElementById(escape(e)).value=s;break;case"html":document.getElementById(escape(e)).innerHTML=s;break;case"gethtml":document.getElementById(escape(e)).innerHTML;break;case"display":document.getElementById(escape(e)).style.display=s;break;case"fontWeight":case"className":document.getElementById(escape(e)).style.fontWeight=s}return!0},calculateTotalPayPal:function(e){var t=this.dom("item_price","get"),s=this.dom("shipping","get"),a=this.dom("handling","get"),i=(this.dom("total_amount","get"),this.math("int",this.math("int",s)+this.math("int",a))),n=this.math("int",t*e),r=this.math("int",this.math("int",i)+this.math("int",n));return this.dom("total_amount","set",r),!0},fetchJSON:function(e){var t=this.xhr();return t.open("GET",e,!0),t.withCredentials=!0,t.setRequestHeader("Access-Control-Allow-Origin","*"),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status)return this.res=t.responseText,this.res},t.send(null),this.res},fetchHTML:function(e,t,s){var a=this.xhr();a.open("GET",e+"&rnd="+this.rnd(),!0),a.withCredentials=!0,a.setRequestHeader("Access-Control-Allow-Origin","*"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(this.res=a.responseText,tinyshop.dom(t,"html",this.res))},a.send(null)},wishlist:function(e,t,s){var a=this.xhr();a.open("GET","/wishlist/"+this.rnd()+"/"+e+"/"+escape(t)+"&tr="+s,!0),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var e=a.responseText.split("|");return"O"==e[0].replace(" ","")?("0"!=s?(tinyshop.dom("fhs"+t,"html",e[1]),tinyshop.dom("favheart"+t,"className","heartfull_png")):(tinyshop.dom("fhs"+t,"html",e[1]),tinyshop.dom("favheart"+t,"className","favheart_fixed")),!1):"X"==e[0].replace(" ","")&&("0"!=s?(tinyshop.dom("fhs"+t,"html",e[1]),tinyshop.dom("favheart"+t,"className","heart_png")):(tinyshop.dom("fhs"+t,"html",e[1]),tinyshop.dom("favheart"+t,"className","favheart")),!1)}},a.send(null)},calculatetotal:function(e,t,s){var a=tinyshop.fetchJSON("../shop/inventory/shipping.json");this.message(a);var n=JSON.parse(a);this.message(n),this.message(n.typeof);for(i in n)n[i];this.message("")},redeemVoucher:function(){var e=this.dom("voucher","get");if(""==e)this.message("Please enter voucher code. This code is a sequence of numbers and letters.");else{var t=this.xhr();t.open("GET","/query/"+this.rnd()+"/voucher/"+escape(e)+"/",!0),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status)if(t.responseText){var e=t.responseText.split("|");if("OK"==e[0].replace(" ","")){var s=this.dom("total","gethtml");s=s.replace("&euro;","").replace(/\u20ac/g,"").replace(",",".").replace(" ","");var a=this.math("float",s);if(""!=e[1])var i=e[1],n=a-this.math("float",i);else if(""!=e[2]&&"|"!=e[2])n=a-a/100*e[2];a<0?this.message("The amount is too tow to redeem the voucher."):"NaN"==n.toFixed(2)?this.dom("total","html","&euro;"+n):this.dom("total","html","&euro;"+n.toFixed(2))}else"ERR"==e[0].replace(" ","")?this.message("Code has already been redeemed, or is wrong."):this.message("There was a problem with redeeming the voucher code. Please check if the code is correct.")}else this.message("There was a problem with redeeming. Please check if the code is correct.")},t.send(null)}}};
